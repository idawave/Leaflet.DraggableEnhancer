L.Draggable.include({_onDownLegacy:L.Draggable.prototype._onDown,_finishDragLegacy:L.Draggable.prototype.finishDrag,_onMoveWrapper:function(n){this._remotelyDisabled||(L.DomEvent.stopPropagation(n),this._onMove(n))},_onUpWrapper:function(n){L.DomEvent.stopPropagation(n),this._onUp(n)},_onDown:function(n){var o=n.type;this._onDownLegacy.call(this,n),L.DomEvent.on(this._dragStartTarget,L.Draggable.MOVE[o],this._onMoveWrapper,this).on(this._dragStartTarget,L.Draggable.END[o],this._onUpWrapper,this)},finishDrag:function(){var n;this._finishDragLegacy.call(this);for(n in L.Draggable.MOVE)L.DomEvent.off(this._dragStartTarget,L.Draggable.MOVE[n],this._onMoveWrapper,this).off(this._dragStartTarget,L.Draggable.END[n],this._onUpWrapper,this)}}),L.Map.BoxZoom.include({_onMouseDownLegacy:L.Map.BoxZoom.prototype._onMouseDown,_finishLegacy:L.Map.BoxZoom.prototype._finish,_onMouseDown:function(n){var o=this._onMouseDownLegacy.call(this,n);return o===!1?o:void this._handleMapEvents("on")._handlePanning(!0)},_finish:function(){this._finishLegacy.call(this),this._handleMapEvents("off")._handlePanning(!1)},_handleMapEvents:function(n){return L.DomEvent[n](this._container,{contextmenu:L.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this),this},_handlePanning:function(n){return this._map.dragging&&this._map.dragging._draggable&&(this._map.dragging._draggable._remotelyDisabled=n),this}});